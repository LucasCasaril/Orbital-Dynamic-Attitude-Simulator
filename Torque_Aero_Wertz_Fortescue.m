function y = Torque_Aero_Wertz_Fortescue(u)

% posicao é o vetor que mostra as posicoes de cada elemento
posicao =[0.0500   -0.0400    0.0400;
    0.0500   -0.0200    0.0400;
    0.0500         0    0.0400;
    0.0500    0.0200    0.0400;
    0.0500    0.0400    0.0400;
    0.0500   -0.0400    0.0200;
    0.0500   -0.0200    0.0200;
    0.0500         0    0.0200;
    0.0500    0.0200    0.0200;
    0.0500    0.0400    0.0200;
    0.0500   -0.0400         0;
    0.0500   -0.0200         0;
    0.0500         0         0;
    0.0500    0.0200         0;
    0.0500    0.0400         0;
    0.0500   -0.0400   -0.0200;
    0.0500   -0.0200   -0.0200;
    0.0500         0   -0.0200;
    0.0500    0.0200   -0.0200;
    0.0500    0.0400   -0.0200;
    0.0500   -0.0400   -0.0400;
    0.0500   -0.0200   -0.0400;
    0.0500         0   -0.0400;
    0.0500    0.0200   -0.0400;
    0.0500    0.0400   -0.0400;
    0.0400    0.0500    0.0400;
    0.0200    0.0500    0.0400;
         0    0.0500    0.0400;
   -0.0200    0.0500    0.0400;
   -0.0400    0.0500    0.0400;
    0.0400    0.0500    0.0200;
    0.0200    0.0500    0.0200;
         0    0.0500    0.0200;
   -0.0200    0.0500    0.0200;
   -0.0400    0.0500    0.0200;
    0.0400    0.0500         0;
    0.0200    0.0500         0;
         0    0.0500         0;
   -0.0200    0.0500         0;
   -0.0400    0.0500         0;
    0.0400    0.0500   -0.0200;
    0.0200    0.0500   -0.0200;
         0    0.0500   -0.0200;
   -0.0200    0.0500   -0.0200;
   -0.0400    0.0500   -0.0200;
    0.0400    0.0500   -0.0400;
    0.0200    0.0500   -0.0400;
         0    0.0500   -0.0400;
   -0.0200    0.0500   -0.0400;
   -0.0400    0.0500   -0.0400;
   -0.0500   -0.0400    0.0400;
   -0.0500   -0.0200    0.0400;
   -0.0500         0    0.0400;
   -0.0500    0.0200    0.0400;
   -0.0500    0.0400    0.0400;
   -0.0500   -0.0400    0.0200;
   -0.0500   -0.0200    0.0200;
   -0.0500         0    0.0200;
   -0.0500    0.0200    0.0200;
   -0.0500    0.0400    0.0200;
   -0.0500   -0.0400         0;
   -0.0500   -0.0200         0;
   -0.0500         0         0;
   -0.0500    0.0200         0;
   -0.0500    0.0400         0;
   -0.0500   -0.0400   -0.0200;
   -0.0500   -0.0200   -0.0200;
   -0.0500         0   -0.0200;
   -0.0500    0.0200   -0.0200;
   -0.0500    0.0400   -0.0200;
   -0.0500   -0.0400   -0.0400;
   -0.0500   -0.0200   -0.0400;
   -0.0500         0   -0.0400;
   -0.0500    0.0200   -0.0400;
   -0.0500    0.0400   -0.0400;
    0.0500   -0.0400   -0.0400;
    0.0400   -0.0500    0.0400;
    0.0200   -0.0500    0.0400;
         0   -0.0500    0.0400;
   -0.0200   -0.0500    0.0400;
   -0.0400   -0.0500    0.0400;
    0.0400   -0.0500    0.0200;
    0.0200   -0.0500    0.0200;
         0   -0.0500    0.0200;
   -0.0200   -0.0500    0.0200;
   -0.0400   -0.0500    0.0200;
    0.0400   -0.0500         0;
    0.0200   -0.0500         0;
         0   -0.0500         0;
   -0.0200   -0.0500         0;
   -0.0400   -0.0500         0;
    0.0400   -0.0500   -0.0200;
    0.0200   -0.0500   -0.0200;
         0   -0.0500   -0.0200;
   -0.0200   -0.0500   -0.0200;
   -0.0400   -0.0500   -0.0200;
    0.0400   -0.0500   -0.0400;
    0.0200   -0.0500   -0.0400;
         0   -0.0500   -0.0400;
   -0.0200   -0.0500   -0.0400;
   -0.0400   -0.0400    0.0500;
   -0.0400   -0.0200    0.0500;
   -0.0400         0    0.0500;
   -0.0400    0.0200    0.0500;
   -0.0400    0.0400    0.0500;
   -0.0200   -0.0400    0.0500;
   -0.0200   -0.0200    0.0500;
   -0.0200         0    0.0500;
   -0.0200    0.0200    0.0500;
   -0.0200    0.0400    0.0500;
         0   -0.0400    0.0500;
         0   -0.0200    0.0500;
         0         0    0.0500;
         0    0.0200    0.0500;
         0    0.0400    0.0500;
    0.0200   -0.0400    0.0500;
    0.0200   -0.0200    0.0500;
    0.0200         0    0.0500;
    0.0200    0.0200    0.0500;
    0.0200    0.0400    0.0500;
    0.0400   -0.0400    0.0500;
    0.0400   -0.0200    0.0500;
    0.0400         0    0.0500;
    0.0400    0.0200    0.0500;
    0.0400    0.0400    0.0500;
   -0.0400   -0.0400   -0.0500;
   -0.0400   -0.0200   -0.0500;
   -0.0400         0   -0.0500;
   -0.0400    0.0200   -0.0500;
   -0.0400    0.0400   -0.0500;
   -0.0200   -0.0400   -0.0500;
   -0.0200   -0.0200   -0.0500;
   -0.0200         0   -0.0500;
   -0.0200    0.0200   -0.0500;
   -0.0200    0.0400   -0.0500;
         0   -0.0400   -0.0500;
         0   -0.0200   -0.0500;
         0         0   -0.0500;
         0    0.0200   -0.0500;
         0    0.0400   -0.0500;
    0.0200   -0.0400   -0.0500;
    0.0200   -0.0200   -0.0500;
    0.0200         0   -0.0500;
    0.0200    0.0200   -0.0500;
    0.0200    0.0400   -0.0500;
    0.0400   -0.0400   -0.0500;
    0.0400   -0.0200   -0.0500;
    0.0400         0   -0.0500;
    0.0400    0.0200   -0.0500;
    0.0400    0.0400   -0.0500];
           
% n são vetores unitários que saem da face 
n = [1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     1, 0, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     0, 1, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     -1, 0, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, -1, 0;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, 1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1;
     0, 0, -1];

   

direcao_velocidade = [u(1) u(2) u(3)];
forca = direcao_velocidade;
Va = direcao_velocidade;

Cd = u(4);
Vel_Quadrado = u(5);

rho_ar = 2.418e-11; % Para 300 km

Area = (0.02^2);

j = 0;
for i = 1:150
   n_elemento = n(i,:);
   Angulo = acosd((dot(n_elemento,forca))/(norm(n_elemento)*norm(forca)));
   
   if Angulo > 90
       j = j +1;
       elementos(j) = (i); % Me fala quais são as faces que precisam ser contabilizadas;
   end
end

k=0;
for i = elementos
   k = k + 1;
   xp(k) = posicao(i,1);
   yp(k) = posicao(i,2);
   zp(k) = posicao(i,3);
   
   nx(k) = n(i,1);
   ny(k) = n(i,2);
   nz(k) = n(i,3);
end

Torque_Aero = 0;
for t = 1:length(elementos)
    n = [nx(t) ny(t) nz(t)];
    r = [xp(t) yp(t) zp(t)];
    
    escalar = dot(n,Va); % Va é a direção da força.
    % escalar_vel = (escalar)*(-Va); % Segundo Wertz (1978)
    
    Forca1 = -(1/2)*(rho_ar)*(Vel_Quadrado)*(Cd)*(Area)*(escalar*(Va(1)));
    Forca2 = -(1/2)*(rho_ar)*(Vel_Quadrado)*(Cd)*(Area)*(escalar*(Va(2)));
    Forca3 = -(1/2)*(rho_ar)*(Vel_Quadrado)*(Cd)*(Area)*(escalar*(Va(3)));
    
    Forca = [Forca1 Forca2 Forca3];
    
    Torque = cross(r,Forca);
    Torque_Aero = Torque_Aero + Torque;
end


y = Torque_Aero;
end